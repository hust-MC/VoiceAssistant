# ä¸ºä»€ä¹ˆç»Ÿä¸€ç®¡ç†çŠ¶æ€ï¼Ÿç»Ÿä¸€ vs ç‹¬ç«‹

## ğŸ¤” ä½ çš„ç–‘é—®

**ä¸ºä»€ä¹ˆä¸è¿™æ ·è®¾è®¡ï¼Ÿ**

```kotlin
// æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç†ï¼ˆä½ è§‰å¾—æ›´ç®€å•ï¼‰
class VehicleStateRepository {
    private val _acState = MutableStateFlow(ACState())
    val acState: StateFlow<ACState> = _acState.asStateFlow()
    
    private val _doorState = MutableStateFlow(DoorState())
    val doorState: StateFlow<DoorState> = _doorState.asStateFlow()
    
    private val _engineState = MutableStateFlow(EngineState())
    val engineState: StateFlow<EngineState> = _engineState.asStateFlow()
}
```

**è€Œæ˜¯è¿™æ ·è®¾è®¡ï¼Ÿ**

```kotlin
// æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç†ï¼ˆå½“å‰é¡¹ç›®ï¼‰
class VehicleStateRepository {
    private val _vehicleState = MutableStateFlow(VehicleState())
    val vehicleState: StateFlow<VehicleState> = _vehicleState.asStateFlow()
}

// ViewModel ä¸­å† map å‡ºæ¥
val acState: StateFlow<ACState> = vehicleState.map { it.ac }.stateIn(...)
```

**ç­”æ¡ˆ**ï¼šç»Ÿä¸€ç®¡ç†æœ‰å¤šä¸ªé‡è¦ä¼˜åŠ¿ï¼

---

## ğŸ“Š ä¸¤ç§æ–¹æ¡ˆå¯¹æ¯”

### æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç†ï¼ˆå½“å‰é¡¹ç›®ï¼‰

```kotlin
data class VehicleState(
    val ac: ACState,
    val door: DoorState,
    val engine: EngineState
)

class VehicleStateRepository {
    private val _vehicleState = MutableStateFlow(VehicleState())
    val vehicleState: StateFlow<VehicleState> = _vehicleState.asStateFlow()
    
    // æ›´æ–°ç©ºè°ƒ
    fun updateACState(acState: ACState) {
        _vehicleState.value = _vehicleState.value.copy(ac = acState)
    }
    
    // æ›´æ–°è½¦é—¨
    fun updateDoorState(doorState: DoorState) {
        _vehicleState.value = _vehicleState.value.copy(door = doorState)
    }
}
```

### æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç†ï¼ˆä½ çš„æƒ³æ³•ï¼‰

```kotlin
class VehicleStateRepository {
    private val _acState = MutableStateFlow(ACState())
    val acState: StateFlow<ACState> = _acState.asStateFlow()
    
    private val _doorState = MutableStateFlow(DoorState())
    val doorState: StateFlow<DoorState> = _doorState.asStateFlow()
    
    private val _engineState = MutableStateFlow(EngineState())
    val engineState: StateFlow<EngineState> = _engineState.asStateFlow()
    
    // æ›´æ–°ç©ºè°ƒ
    fun updateACState(acState: ACState) {
        _acState.value = acState
    }
    
    // æ›´æ–°è½¦é—¨
    fun updateDoorState(doorState: DoorState) {
        _doorState.value = doorState
    }
}
```

---

## âœ… ç»Ÿä¸€ç®¡ç†çš„ä¼˜åŠ¿

### 1. æ•°æ®ä¸€è‡´æ€§ï¼šåŸå­æ€§æ“ä½œ

**åœºæ™¯**ï¼šéœ€è¦åŒæ—¶æ›´æ–°å¤šä¸ªçŠ¶æ€ï¼Œä¿è¯å®ƒä»¬ä¸€è‡´

```kotlin
// ========== åœºæ™¯ï¼šå¯åŠ¨è½¦è¾† ==========
// éœ€è¦åŒæ—¶ï¼š
// 1. å¼•æ“å¯åŠ¨
// 2. è½¦é—¨è‡ªåŠ¨ä¸Šé”
// 3. ç©ºè°ƒè‡ªåŠ¨å¼€å¯

// ========== æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç†ï¼ˆâœ… åŸå­æ€§ï¼‰ ==========
fun startEngine() {
    _vehicleState.value = _vehicleState.value.copy(
        engine = EngineState(isRunning = true),
        door = _vehicleState.value.door.copy(isLocked = true),
        ac = _vehicleState.value.ac.copy(isOn = true)
    )
    // âœ… ä¸€æ¬¡æ›´æ–°ï¼Œæ‰€æœ‰çŠ¶æ€åŒæ—¶æ”¹å˜
    // âœ… UI çœ‹åˆ°çš„æ˜¯å®Œæ•´çš„çŠ¶æ€å¿«ç…§
}

// ========== æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç†ï¼ˆâŒ å¯èƒ½ä¸ä¸€è‡´ï¼‰ ==========
fun startEngine() {
    _engineState.value = EngineState(isRunning = true)
    _doorState.value = _doorState.value.copy(isLocked = true)
    _acState.value = _acState.value.copy(isOn = true)
    // âŒ ä¸‰æ¬¡ç‹¬ç«‹æ›´æ–°
    // âŒ UI å¯èƒ½çœ‹åˆ°ä¸­é—´çŠ¶æ€ï¼šå¼•æ“å¯åŠ¨äº†ï¼Œä½†é—¨è¿˜æ²¡é”
}
```

**é—®é¢˜æ¼”ç¤º**ï¼š

```
æ–¹æ¡ˆ2çš„æ—¶é—´çº¿ï¼š
æ—¶åˆ»1ï¼š_engineState æ›´æ–° â†’ UIæ˜¾ç¤ºï¼šå¼•æ“å¯åŠ¨ âœ…
æ—¶åˆ»2ï¼š_doorState æ›´æ–° â†’ UIæ˜¾ç¤ºï¼šå¼•æ“å¯åŠ¨ âœ… + è½¦é—¨é”å®š âœ…
æ—¶åˆ»3ï¼š_acState æ›´æ–° â†’ UIæ˜¾ç¤ºï¼šå¼•æ“å¯åŠ¨ âœ… + è½¦é—¨é”å®š âœ… + ç©ºè°ƒå¼€å¯ âœ…

åœ¨è¿™æœŸé—´ï¼ŒUI å¯èƒ½çœ‹åˆ°ï¼š
- å¼•æ“å¯åŠ¨äº†ï¼Œä½†è½¦é—¨è¿˜æ²¡é”ï¼ˆä¸ä¸€è‡´ï¼ï¼‰
- æˆ–è€…å¼•æ“å¯åŠ¨äº†ï¼Œè½¦é—¨é”äº†ï¼Œä½†ç©ºè°ƒè¿˜æ²¡å¼€ï¼ˆä¸ä¸€è‡´ï¼ï¼‰
```

---

### 2. äº‹åŠ¡æ€§æ“ä½œï¼šè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥

**åœºæ™¯**ï¼šæŸäº›æ“ä½œå¿…é¡»ä¿è¯å¤šä¸ªçŠ¶æ€çš„ä¸€è‡´æ€§

```kotlin
// ========== åœºæ™¯ï¼šç´§æ€¥åœè½¦ ==========
// éœ€è¦åŒæ—¶ï¼š
// 1. å¼•æ“ç†„ç«
// 2. è½¦é—¨è§£é”ï¼ˆæ–¹ä¾¿é€ƒç”Ÿï¼‰
// 3. æ‰€æœ‰è½¦çª—æ‰“å¼€

// ========== æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç†ï¼ˆâœ… äº‹åŠ¡æ€§ï¼‰ ==========
fun emergencyStop() {
    _vehicleState.value = _vehicleState.value.copy(
        engine = EngineState(isRunning = false),
        door = DoorState(isLocked = false),
        window = WindowState(
            frontLeft = FULL_OPEN,
            frontRight = FULL_OPEN,
            rearLeft = FULL_OPEN,
            rearRight = FULL_OPEN
        )
    )
    // âœ… ä¸€ä¸ªæ“ä½œï¼Œæ‰€æœ‰çŠ¶æ€åŒæ—¶æ›´æ–°
    // âœ… å¦‚æœæŸä¸ªçŠ¶æ€æ›´æ–°å¤±è´¥ï¼Œæ•´ä¸ªæ“ä½œéƒ½å¤±è´¥ï¼ˆæ•°æ®ä¸€è‡´ï¼‰
}

// ========== æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç†ï¼ˆâŒ éƒ¨åˆ†å¤±è´¥ï¼‰ ==========
fun emergencyStop() {
    _engineState.value = EngineState(isRunning = false)
    _doorState.value = DoorState(isLocked = false)
    _windowState.value = WindowState(...)  // å‡è®¾è¿™é‡Œå‡ºé”™äº†ï¼Ÿ
    // âŒ å¦‚æœæœ€åä¸€ä¸ªæ›´æ–°å¤±è´¥ï¼Œå‰é¢çš„å·²ç»æ›´æ–°äº†
    // âŒ æ•°æ®ä¸ä¸€è‡´ï¼šå¼•æ“ç†„ç«äº†ï¼Œä½†è½¦é—¨å¯èƒ½è¿˜æ²¡è§£é”
}
```

---

### 3. çŠ¶æ€å…³è”ï¼šä¸€ä¸ªçŠ¶æ€ä¾èµ–äºå¦ä¸€ä¸ªçŠ¶æ€

**åœºæ™¯**ï¼šæŸäº›çŠ¶æ€ä¹‹é—´æœ‰ä¾èµ–å…³ç³»

```kotlin
// ========== åœºæ™¯ï¼šå¼•æ“å…³é—­æ—¶ï¼Œè‡ªåŠ¨å…³é—­ç©ºè°ƒ ==========

// ========== æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç†ï¼ˆâœ… å®¹æ˜“å¤„ç†ä¾èµ–ï¼‰ ==========
fun turnOffEngine() {
    _vehicleState.value = _vehicleState.value.copy(
        engine = EngineState(isRunning = false),
        ac = if (!_vehicleState.value.engine.isRunning) {
            _vehicleState.value.ac.copy(isOn = false)  // å¼•æ“å…³é—­ï¼Œç©ºè°ƒä¹Ÿå…³é—­
        } else {
            _vehicleState.value.ac
        }
    )
    // âœ… åœ¨åŒä¸€ä¸ªåœ°æ–¹ï¼Œå®¹æ˜“å¤„ç†çŠ¶æ€ä¾èµ–
}

// ========== æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç†ï¼ˆâŒ å®¹æ˜“å‡ºé”™ï¼‰ ==========
fun turnOffEngine() {
    _engineState.value = EngineState(isRunning = false)
    
    // âš ï¸ é—®é¢˜ï¼šè°è´Ÿè´£æ›´æ–°ç©ºè°ƒï¼Ÿ
    // å¦‚æœåœ¨å…¶ä»–åœ°æ–¹æ›´æ–°å¼•æ“ï¼Œå¯èƒ½å¿˜è®°å…³é—­ç©ºè°ƒ
    // éœ€è¦åˆ°å¤„æ£€æŸ¥ä¾èµ–å…³ç³»
}

// æˆ–è€…éœ€è¦è¿™æ ·ï¼š
fun turnOffEngine() {
    _engineState.value = EngineState(isRunning = false)
    _acState.value = _acState.value.copy(isOn = false)  // æ‰‹åŠ¨å¤„ç†ä¾èµ–
    // âŒ å®¹æ˜“å¿˜è®°
    // âŒ å¦‚æœå…¶ä»–åœ°æ–¹æ›´æ–°å¼•æ“ï¼Œå¯èƒ½å¿˜è®°è¿™ä¸ªä¾èµ–
}
```

---

### 4. çŠ¶æ€å¿«ç…§ï¼šæŸ¥çœ‹æŸä¸€æ—¶åˆ»çš„å®Œæ•´çŠ¶æ€

**åœºæ™¯**ï¼šéœ€è¦è·å–æŸä¸ªæ—¶åˆ»çš„å®Œæ•´è½¦è¾†çŠ¶æ€

```kotlin
// ========== æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç†ï¼ˆâœ… å¤©ç„¶çš„å¿«ç…§ï¼‰ ==========
fun getCurrentState(): VehicleState {
    return _vehicleState.value  // è¿”å›å®Œæ•´çš„ã€ä¸€è‡´çš„å¿«ç…§
    // âœ… ä¿è¯æ‰€æœ‰çŠ¶æ€æ˜¯åŒä¸€æ—¶åˆ»çš„
    // âœ… ä¾‹å¦‚ï¼šå¼•æ“å¯åŠ¨æ—¶çš„æ¸©åº¦æ˜¯25Â°Cï¼ˆè€Œä¸æ˜¯ä¹‹å‰æ›´æ–°çš„26Â°Cï¼‰
}

// ä½¿ç”¨åœºæ™¯ï¼š
val state = repository.getCurrentState()
if (state.engine.isRunning && state.ac.temperature > 25) {
    // åˆ¤æ–­ï¼šå¼•æ“è¿è¡Œæ—¶ï¼Œæ¸©åº¦æ˜¯å¦è¿‡é«˜
    // âœ… ä¿è¯ engine å’Œ ac æ˜¯åŒä¸€æ—¶åˆ»çš„çŠ¶æ€
}

// ========== æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç†ï¼ˆâŒ å¯èƒ½ä¸ä¸€è‡´ï¼‰ ==========
fun getCurrentState(): VehicleState {
    return VehicleState(
        ac = _acState.value,      // æ—¶åˆ» T1 çš„çŠ¶æ€
        door = _doorState.value,  // æ—¶åˆ» T2 çš„çŠ¶æ€ï¼ˆT2 å¯èƒ½ > T1ï¼‰
        engine = _engineState.value // æ—¶åˆ» T3 çš„çŠ¶æ€ï¼ˆT3 å¯èƒ½ > T2ï¼‰
    )
    // âŒ æ¯ä¸ªçŠ¶æ€æ˜¯ä¸åŒæ—¶åˆ»çš„å¿«ç…§
    // âŒ å¯èƒ½ä¸ä¸€è‡´ï¼šå¼•æ“å¯åŠ¨æ—¶ï¼Œæ¸©åº¦æ˜¯æ—§çš„
}
```

**å®é™…é—®é¢˜**ï¼š

```
æ–¹æ¡ˆ2çš„æ—¶é—´çº¿ï¼š
T1: æ›´æ–°æ¸©åº¦ 24Â°C â†’ 25Â°C
T2: æ›´æ–°å¼•æ“ å…³é—­ â†’ å¯åŠ¨
T3: è°ƒç”¨ getCurrentState()

ç»“æœï¼š
VehicleState(
    ac = ACState(temperature: 25),    // T1 çš„å€¼
    engine = EngineState(isRunning: true)  // T2 çš„å€¼
)

é—®é¢˜ï¼šT1 æ›´æ–°æ¸©åº¦æ—¶ï¼Œå¼•æ“è¿˜æ²¡å¯åŠ¨ï¼ˆ24Â°Cæ—¶å¼•æ“æ˜¯å…³é—­çš„ï¼‰
ä½†ç°åœ¨ getCurrentState() è¿”å›ï¼šæ¸©åº¦25Â°C + å¼•æ“å¯åŠ¨
è¿™ä¸ä¸€è‡´ï¼24Â°Cæ—¶å¼•æ“å…³é—­ï¼Œ25Â°Cæ—¶å¼•æ“å¯åŠ¨ï¼Œä½†å®ƒä»¬ä¸æ˜¯åŒä¸€ä¸ªçŠ¶æ€å¿«ç…§
```

---

### 5. åºåˆ—åŒ–/æŒä¹…åŒ–ï¼šä¿å­˜å®Œæ•´çŠ¶æ€

**åœºæ™¯**ï¼šéœ€è¦ä¿å­˜è½¦è¾†çŠ¶æ€åˆ°æœ¬åœ°æˆ–å‘é€åˆ°æœåŠ¡å™¨

```kotlin
// ========== æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç†ï¼ˆâœ… ç®€å•ï¼‰ ==========
fun saveState() {
    val state = _vehicleState.value
    // ä¿å­˜ä¸º JSON
    val json = gson.toJson(state)  // {"ac": {...}, "door": {...}, ...}
    // âœ… ä¸€ä¸ªå¯¹è±¡ï¼Œå®Œæ•´ä¿å­˜
    // âœ… æ¢å¤æ—¶ä¹Ÿæ˜¯ä¸€ä¸ªæ“ä½œï¼Œä¿è¯ä¸€è‡´æ€§
}

// ========== æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç†ï¼ˆâŒ å¤æ‚ä¸”å®¹æ˜“ä¸ä¸€è‡´ï¼‰ ==========
fun saveState() {
    val acJson = gson.toJson(_acState.value)
    val doorJson = gson.toJson(_doorState.value)
    val engineJson = gson.toJson(_engineState.value)
    // âŒ ä¸‰ä¸ªç‹¬ç«‹æ“ä½œ
    // âŒ å¦‚æœä¿å­˜è¿‡ç¨‹ä¸­æŸä¸ªçŠ¶æ€æ›´æ–°äº†ï¼Œæ•°æ®å°±ä¸ä¸€è‡´äº†
    // âŒ æ¢å¤æ—¶éœ€è¦åˆ†åˆ«æ¢å¤ï¼Œå®¹æ˜“å‡ºé”™
}
```

---

### 6. è°ƒè¯•å’Œç»´æŠ¤ï¼šæ›´å®¹æ˜“è¿½è¸ªçŠ¶æ€å˜åŒ–

**åœºæ™¯**ï¼šéœ€è¦è°ƒè¯•çŠ¶æ€å˜åŒ–

```kotlin
// ========== æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç†ï¼ˆâœ… å®¹æ˜“è¿½è¸ªï¼‰ ==========
fun updateACState(acState: ACState) {
    val oldState = _vehicleState.value
    _vehicleState.value = _vehicleState.value.copy(ac = acState)
    val newState = _vehicleState.value
    
    // âœ… å¯ä»¥è®°å½•å®Œæ•´çš„"ä¹‹å‰"å’Œ"ä¹‹å"çŠ¶æ€
    Log.d(TAG, "State changed: $oldState -> $newState")
}

// ========== æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç†ï¼ˆâŒ éš¾ä»¥è¿½è¸ªï¼‰ ==========
fun updateACState(acState: ACState) {
    val oldAC = _acState.value
    _acState.value = acState
    
    // âŒ åªèƒ½çœ‹åˆ° AC çš„å˜åŒ–ï¼Œçœ‹ä¸åˆ°å…¶ä»–çŠ¶æ€
    // âŒ å¦‚æœ AC å˜åŒ–å½±å“äº†å…¶ä»–çŠ¶æ€ï¼Œéš¾ä»¥è¿½è¸ª
}
```

---

## ğŸ“Š å®é™…é¡¹ç›®åœºæ™¯

### åœºæ™¯1ï¼šç”¨æˆ·è¯´"å¯åŠ¨è½¦è¾†"

```kotlin
// éœ€è¦åŒæ—¶æ›´æ–°ï¼š
// - å¼•æ“å¯åŠ¨
// - è½¦é—¨é”å®š
// - ç©ºè°ƒå¼€å¯ï¼ˆæ ¹æ®æ¸©åº¦ï¼‰

// ========== æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç† ==========
fun processCommand("å¯åŠ¨è½¦è¾†") {
    _vehicleState.value = _vehicleState.value.copy(
        engine = EngineState(isRunning = true),
        door = DoorState(isLocked = true),
        ac = ACState(isOn = true, temperature = 24)
    )
    // âœ… ä¸€ä¸ªæ“ä½œï¼ŒçŠ¶æ€ä¸€è‡´
}

// ========== æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç† ==========
fun processCommand("å¯åŠ¨è½¦è¾†") {
    _engineState.value = EngineState(isRunning = true)
    _doorState.value = DoorState(isLocked = true)
    _acState.value = ACState(isOn = true, temperature = 24)
    // âš ï¸ ä¸‰æ¬¡æ›´æ–°ï¼Œä¸­é—´å¯èƒ½è¢«å…¶ä»–æ“ä½œæ‰“æ–­
}
```

### åœºæ™¯2ï¼šç½‘ç»œåŒæ­¥

```kotlin
// ä»æœåŠ¡å™¨æ¥æ”¶çŠ¶æ€æ›´æ–°
// ========== æ–¹æ¡ˆ1ï¼šç»Ÿä¸€ç®¡ç† ==========
fun syncFromServer(json: String) {
    val newState = gson.fromJson(json, VehicleState::class.java)
    _vehicleState.value = newState
    // âœ… ä¸€æ¬¡æ›´æ–°ï¼ŒçŠ¶æ€ä¸€è‡´
}

// ========== æ–¹æ¡ˆ2ï¼šç‹¬ç«‹ç®¡ç† ==========
fun syncFromServer(json: String) {
    val vehicleState = gson.fromJson(json, VehicleState::class.java)
    _acState.value = vehicleState.ac
    _doorState.value = vehicleState.door
    _engineState.value = vehicleState.engine
    // âš ï¸ ä¸‰æ¬¡æ›´æ–°ï¼Œå¦‚æœç½‘ç»œä¸­æ–­ï¼Œå¯èƒ½åªæ›´æ–°äº†éƒ¨åˆ†çŠ¶æ€
}
```

---

## ğŸ¤” é‚£ä¸ºä»€ä¹ˆä¸ç›´æ¥ç”¨ç‹¬ç«‹çš„ StateFlowï¼Ÿ

**å¦‚æœä½ çš„åœºæ™¯æ»¡è¶³ä»¥ä¸‹æ¡ä»¶ï¼Œç¡®å®å¯ä»¥ç”¨ç‹¬ç«‹ç®¡ç†**ï¼š
1. âœ… çŠ¶æ€ä¹‹é—´**å®Œå…¨ç‹¬ç«‹**ï¼Œæ²¡æœ‰ä¾èµ–
2. âœ… ä¸éœ€è¦**åŸå­æ€§æ›´æ–°**å¤šä¸ªçŠ¶æ€
3. âœ… ä¸éœ€è¦**çŠ¶æ€å¿«ç…§**
4. âœ… ä¸éœ€è¦**äº‹åŠ¡æ€§æ“ä½œ**

**ä½†å®é™…æƒ…å†µä¸­ï¼Œè½¦è¾†çŠ¶æ€å¾€å¾€æ˜¯æœ‰å…³è”çš„**ï¼š
- å¼•æ“å¯åŠ¨æ—¶ï¼Œéœ€è¦é”å®šè½¦é—¨
- å¼•æ“å…³é—­æ—¶ï¼Œéœ€è¦å…³é—­ç©ºè°ƒ
- éœ€è¦è·å–"æŸä¸€æ—¶åˆ»çš„å®Œæ•´çŠ¶æ€"ç”¨äºåˆ¤æ–­

æ‰€ä»¥**ç»Ÿä¸€ç®¡ç†æ›´é€‚åˆ**ï¼

---

## âœ… æ€»ç»“

### ç»Ÿä¸€ç®¡ç†çš„ä¼˜åŠ¿

| ä¼˜åŠ¿ | è¯´æ˜ |
|------|------|
| **æ•°æ®ä¸€è‡´æ€§** | å¤šä¸ªçŠ¶æ€åŒæ—¶æ›´æ–°ï¼Œä¿è¯ä¸€è‡´ |
| **åŸå­æ€§æ“ä½œ** | è¦ä¹ˆå…¨éƒ¨æ›´æ–°ï¼Œè¦ä¹ˆå…¨éƒ¨ä¸æ›´æ–° |
| **çŠ¶æ€å…³è”** | å®¹æ˜“å¤„ç†çŠ¶æ€ä¹‹é—´çš„ä¾èµ–å…³ç³» |
| **çŠ¶æ€å¿«ç…§** | å¯ä»¥è·å–æŸä¸€æ—¶åˆ»çš„å®Œæ•´çŠ¶æ€ |
| **åºåˆ—åŒ–** | ä¿å­˜/æ¢å¤æ›´æ–¹ä¾¿ï¼Œä¿è¯ä¸€è‡´æ€§ |
| **è°ƒè¯•** | æ›´å®¹æ˜“è¿½è¸ªå®Œæ•´çš„çŠ¶æ€å˜åŒ– |

### ä»€ä¹ˆæ—¶å€™ç”¨ç‹¬ç«‹ç®¡ç†ï¼Ÿ

- çŠ¶æ€ä¹‹é—´**å®Œå…¨ç‹¬ç«‹**
- ä¸éœ€è¦**åŸå­æ€§æ›´æ–°**
- çŠ¶æ€æ•°é‡**å¾ˆå°‘**ä¸”**ç®€å•**

### é¡¹ç›®ä¸­çš„é€‰æ‹©

**è½¦è¾†çŠ¶æ€**æœ‰æ˜æ˜¾çš„å…³è”æ€§ï¼š
- å¼•æ“ â†” ç©ºè°ƒ
- å¼•æ“ â†” è½¦é—¨
- éœ€è¦å®Œæ•´çš„çŠ¶æ€å¿«ç…§

æ‰€ä»¥**ç»Ÿä¸€ç®¡ç†æ˜¯æ­£ç¡®çš„é€‰æ‹©**ï¼

è™½ç„¶éœ€è¦ `map` å’Œ `stateIn` æ¥æå–å­çŠ¶æ€ï¼Œä½†æ¢æ¥çš„æ˜¯**æ•°æ®ä¸€è‡´æ€§**å’Œ**æ›´å¥½çš„å¯ç»´æŠ¤æ€§**ã€‚

---

## ğŸ¯ è®¾è®¡åŸåˆ™

```
æ•°æ®ç®¡ç†åŸåˆ™ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å¦‚æœæ•°æ®æœ‰å…³è” â†’ ç»Ÿä¸€ç®¡ç†           â”‚
â”‚  å¦‚æœæ•°æ®ç‹¬ç«‹ â†’ å¯ä»¥ç‹¬ç«‹ç®¡ç†         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

è½¦è¾†çŠ¶æ€ï¼šæœ‰å…³è” â†’ ç»Ÿä¸€ç®¡ç† âœ…
ç”¨æˆ·è®¾ç½®ï¼šå¯èƒ½ç‹¬ç«‹ â†’ å¯ä»¥ç‹¬ç«‹ç®¡ç†
```

**åœ¨ä½ çš„é¡¹ç›®ä¸­**ï¼š`VehicleState` æ˜¯ä¸€ä¸ª**ä¸šåŠ¡æ¦‚å¿µ**ï¼ˆè½¦è¾†çš„æ•´ä½“çŠ¶æ€ï¼‰ï¼Œåº”è¯¥ä½œä¸ºä¸€ä¸ªæ•´ä½“ç®¡ç†ï¼Œè¿™æ ·æ›´ç¬¦åˆå®é™…ä¸šåŠ¡é€»è¾‘ï¼


